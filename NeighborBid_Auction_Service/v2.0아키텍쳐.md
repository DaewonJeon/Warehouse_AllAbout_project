
```
================================================================================
                🏛️  NEIGHBORBID HYBRID ARCHITECTURE  🏛️
================================================================================

                           [ 📱 사용자 (Clients) ]
                                    │
        ┌───────────────────────────┴───────────────────────────┐
        │ (1) HTTP 요청                                         │ (2) WebSocket 연결
        │ (로그인, 동네거래, 결제)                                │ (전국 실시간 경매)
        ▼                                                       ▼
+----------------------------------------------------------------------------------+
|                            [ NGINX (Gateway) ]                                   |
|   - URL이 /ws/ 로 시작?  ------------------------------------> (ASGI로 보냄)      |
|   - 그 외 일반 요청?      ------------------------------------> (WSGI로 보냄)      |
+----------------------------------------------------------------------------------+
        │                                                       │
        ▼                                                       ▼
+-----------------------+                         +------------------------------+
| [ WSGI Server ]       |                         | [ ASGI Server ]              |
| (Gunicorn)            |                         | (Daphne / Uvicorn)           |
|                       |                         |                              |
|   Django (일반 View)   |                         |   Django (Consumers)         |
| "안정성 중심"          |                         | "속도 중심 (Turbo)"           |
+-----------------------+                         +------------------------------+
        │                                                       │
        │ (3) 트랜잭션 (직접 저장)                                 │ (4) 메모리 연산 (초고속)
        ▼                                                       ▼
+-----------------------+                         +------------------------------+
| [ PostgreSQL (DB) ]   |                         | [ Redis (Memory) ]           |
|                       |                         |                              |
| - 유저/결제 데이터      |                         | - 실시간 호가(Price) 저장     |
| - 일반 경매 데이터      |                         | - Pub/Sub (방송 송출)        |
|                       |                         +------------------------------+
+-----------------------+                                       │
        ▲                                                       │
        │                                                       │ (5) 비동기 저장 요청
        │                                                       ▼
        │                                         +------------------------------+
        │                                         | [ Celery Worker ]            |
        │            (6) 지연 저장 (Write-Back)     |                              |
        └─────────────────────────────────────────| - 1초마다 DB에 몰아서 저장      |
                                                  | - 경매 종료 처리               |
                                                  +------------------------------+

```


[ 🚀 NeighborBid 개발 진행표 ]

✅ Phase 0. 기본 기능 구현 (완료)
   - 회원가입, 로그인, 일반 경매(CRUD), 지갑 기능

✅ Phase 1. 인프라 & 환경 설정 (방금 완료! 🐳)
   - Docker 도입 (Redis + Django 한방 실행)
   - Channels 설정 (ASGI 모드 전환)
   - 협업 환경 통일

✅ Phase 2. 데이터 구조 잡기 (NOW 🔥)
   - DB에 '전국 실시간' 여부 표시 (is_national)
   - 폼/뷰 수정하여 구분 처리

⬜ Phase 3. 웹소켓 백엔드 구현 (Next)
   - Consumer 작성 (소켓 접속/해제)
   - Redis 연동 (실시간 메시지 방송)

⬜ Phase 4. 프론트엔드 연동 (Final)
   - JavaScript로 소켓 연결
   - 실시간 호가 업데이트 화면 구현


graph TD
    %% 스타일 정의
    classDef client fill:#f9f,stroke:#333,stroke-width:2px;
    classDef gateway fill:#ff9,stroke:#333,stroke-width:2px;
    classDef app fill:#9f9,stroke:#333,stroke-width:2px;
    classDef db fill:#9cf,stroke:#333,stroke-width:2px;

    %% 노드 정의
    User[🙋‍♂️ 사용자 (Client)]:::client
    Nginx[🚦 Gateway / Nginx]:::gateway
    
    subgraph "Django Application (Docker)"
        WSGI[🐢 WSGI Server (Gunicorn)]:::app
        ASGI[⚡ ASGI Server (Daphne)]:::app
        Django[Django Framework]:::app
    end

    subgraph "Data Storage"
        Redis[(🔥 Redis: Pub/Sub)]:::db
        DB[(💾 Database: SQLite/Postgres)]:::db
    end

    %% 흐름 연결
    User -->|1. 일반 요청 (HTTP)| Nginx
    User -->|2. 실시간 연결 (WebSocket)| Nginx

    Nginx -->|/ (일반 경로)| WSGI
    Nginx -->|/ws/ (소켓 경로)| ASGI

    WSGI -->|요청 처리| Django
    ASGI -->|메시지 처리| Django

    Django -->|데이터 저장/조회| DB
    
    %% 실시간 핵심 흐름
    Django -.->|실시간 방송 (Publish)| Redis
    Redis -.->|구독자에게 전송 (Subscribe)| ASGI
    ASGI -.->|즉시 업데이트| User